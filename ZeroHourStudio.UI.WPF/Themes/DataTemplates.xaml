<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:conv="clr-namespace:ZeroHourStudio.UI.WPF.Converters">

    <!-- ═══════════════════════════════════════════════════════════ -->
    <!-- ZeroHour Studio v3.0 - Data Templates                      -->
    <!-- ═══════════════════════════════════════════════════════════ -->

    <!-- ─── Unit Identity Card Template ─── -->
    <DataTemplate x:Key="UnitIdentityCardTemplate">
        <Border Background="#14FFFFFF" CornerRadius="8" Padding="8,6" Margin="2"
                BorderThickness="1,1,1,1" BorderBrush="#15FFFFFF"
                SnapsToDevicePixels="True">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="4"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Faction Color Strip -->
                <Border Grid.Column="0" CornerRadius="2" Width="4" Margin="0,2,8,2">
                    <Border.Background>
                        <SolidColorBrush Color="#FF6B00"/>
                    </Border.Background>
                </Border>

                <!-- Unit Icon -->
                <Border Grid.Column="1" Width="48" Height="48" CornerRadius="6"
                        Background="#1A2332" Margin="0,0,10,0"
                        BorderThickness="1" BorderBrush="#22FFFFFF">
                    <Image Source="{Binding ButtonImage, Converter={StaticResource IconConverter}}"
                           Stretch="Uniform" RenderOptions.BitmapScalingMode="HighQuality"/>
                </Border>

                <!-- Unit Info -->
                <StackPanel Grid.Column="2" VerticalAlignment="Center">
                    <TextBlock Text="{Binding TechnicalName}"
                               FontSize="13" FontWeight="SemiBold" Foreground="White"
                               TextTrimming="CharacterEllipsis"/>
                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                        <TextBlock Text="{Binding Side}" Foreground="#FF6B00" FontSize="11"/>
                    </StackPanel>
                </StackPanel>

                <!-- Build Cost Badge -->
                <Border Grid.Column="3" VerticalAlignment="Center"
                        Background="#1500FF88" BorderBrush="#3300FF88"
                        BorderThickness="1" CornerRadius="10" Padding="8,2">
                    <TextBlock Text="{Binding BuildCost}" Foreground="#00FF88"
                               FontSize="10" FontWeight="Bold"/>
                </Border>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- ─── Dependency Node Template ─── -->
    <HierarchicalDataTemplate x:Key="DependencyNodeTemplate"
                               ItemsSource="{Binding Children}">
        <StackPanel Orientation="Horizontal" Margin="2">
            <!-- Type Icon -->
            <TextBlock x:Name="TypeIcon" Text="&#x25C6;" FontSize="10"
                       Foreground="#00D4FF" VerticalAlignment="Center" Margin="0,0,6,0"/>

            <!-- Name -->
            <TextBlock Text="{Binding Name}" FontSize="12" FontWeight="SemiBold"
                       Foreground="White" VerticalAlignment="Center"/>

            <!-- Type Badge -->
            <Border Background="#1500D4FF" CornerRadius="8" Padding="6,1" Margin="6,0,0,0"
                    VerticalAlignment="Center">
                <TextBlock Text="{Binding TypeDisplay}" FontSize="9" Foreground="#00D4FF"/>
            </Border>

            <!-- Status Indicator -->
            <TextBlock x:Name="StatusIcon" Text="&#x2713;" FontSize="11" FontWeight="Bold"
                       Foreground="#00FF88" VerticalAlignment="Center" Margin="6,0,0,0"/>
        </StackPanel>

        <HierarchicalDataTemplate.Triggers>
            <DataTrigger Binding="{Binding Status}" Value="Missing">
                <Setter TargetName="StatusIcon" Property="Text" Value="&#x2717;"/>
                <Setter TargetName="StatusIcon" Property="Foreground" Value="#FF3366"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Status}" Value="Unknown">
                <Setter TargetName="StatusIcon" Property="Text" Value="?"/>
                <Setter TargetName="StatusIcon" Property="Foreground" Value="#667788"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding TypeDisplay}" Value="Weapon">
                <Setter TargetName="TypeIcon" Property="Foreground" Value="#FF6B00"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding TypeDisplay}" Value="Audio">
                <Setter TargetName="TypeIcon" Property="Foreground" Value="#00FF88"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding TypeDisplay}" Value="Model3D">
                <Setter TargetName="TypeIcon" Property="Foreground" Value="#00D4FF"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding TypeDisplay}" Value="Texture">
                <Setter TargetName="TypeIcon" Property="Foreground" Value="#FFD700"/>
            </DataTrigger>
        </HierarchicalDataTemplate.Triggers>
    </HierarchicalDataTemplate>

    <!-- ─── Faction Group Header Template ─── -->
    <DataTemplate x:Key="FactionGroupHeaderTemplate">
        <Border Padding="10,6" Margin="0,4,0,2" CornerRadius="4"
                Background="#10FFFFFF">
            <StackPanel Orientation="Horizontal">
                <Border Width="4" Height="16" CornerRadius="2" Margin="0,0,8,0">
                    <Border.Background>
                        <SolidColorBrush Color="#FF6B00"/>
                    </Border.Background>
                </Border>
                <TextBlock Text="{Binding FactionName}" FontWeight="Bold" FontSize="13"
                           Foreground="#AABBCC"/>
                <TextBlock Margin="8,0,0,0" FontSize="11" Foreground="#667788"
                           VerticalAlignment="Center">
                    <Run Text="("/>
                    <Run Text="{Binding Units.Count, Mode=OneWay}"/>
                    <Run Text=")"/>
                </TextBlock>
            </StackPanel>
        </Border>
    </DataTemplate>

    <!-- ─── Weapon Chain Template ─── -->
    <DataTemplate x:Key="WeaponChainTemplate">
        <Border Background="#10FF6B00" CornerRadius="6" Padding="8,4" Margin="0,2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Weapon Slot Badge -->
                <Border Grid.Column="0" Background="#22FF6B00" CornerRadius="4" Padding="6,2" Margin="0,0,8,0"
                        VerticalAlignment="Center">
                    <TextBlock Text="{Binding WeaponType}" FontSize="9" FontWeight="Bold"
                               Foreground="#FF6B00"/>
                </Border>

                <!-- Weapon Name -->
                <TextBlock Grid.Column="1" Text="{Binding WeaponName}" FontSize="12"
                           Foreground="White" VerticalAlignment="Center"
                           TextTrimming="CharacterEllipsis"/>

                <!-- Completion Indicator -->
                <TextBlock x:Name="CompletionIcon" Grid.Column="2"
                           Text="&#x2713;" FontSize="12" FontWeight="Bold"
                           Foreground="#00FF88" VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding IsComplete}" Value="False">
                <Setter TargetName="CompletionIcon" Property="Text" Value="&#x26A0;"/>
                <Setter TargetName="CompletionIcon" Property="Foreground" Value="#FFD700"/>
            </DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <!-- ─── Transfer Log Entry Template ─── -->
    <DataTemplate x:Key="TransferLogEntryTemplate">
        <Border Background="#0CFFFFFF" CornerRadius="4" Padding="8,4" Margin="0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="&#x2713;" Foreground="#00FF88" FontWeight="Bold"
                           Margin="0,0,8,0" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="{Binding UnitName}" Foreground="White"
                           FontSize="11" VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                <TextBlock Grid.Column="2" Text="{Binding Timestamp, StringFormat=HH:mm}"
                           Foreground="#667788" FontSize="10" VerticalAlignment="Center"/>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- ─── Conflict Item Template ─── -->
    <DataTemplate x:Key="ConflictItemTemplate">
        <Border Background="#18FF3366" CornerRadius="6" Padding="10,6" Margin="0,2"
                BorderThickness="1" BorderBrush="#33FF3366">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Conflict Name & Type -->
                <StackPanel Grid.Row="0" Grid.Column="0">
                    <TextBlock Text="{Binding DefinitionName}" FontSize="13" FontWeight="SemiBold"
                               Foreground="White"/>
                    <TextBlock FontSize="10" Foreground="#AABBCC" Margin="0,2,0,0">
                        <Run Text="{Binding DefinitionType}"/>
                        <Run Text=" | " Foreground="#445566"/>
                        <Run Text="{Binding Kind}" Foreground="#FF6B00"/>
                    </TextBlock>
                </StackPanel>

                <!-- Suggested Rename -->
                <TextBlock Grid.Row="1" Grid.ColumnSpan="2" Margin="0,4,0,0"
                           FontSize="11" Foreground="#00D4FF">
                    <Run Text="&#x2192; " Foreground="#667788"/>
                    <Run Text="{Binding SuggestedRename}"/>
                </TextBlock>
            </Grid>
        </Border>
    </DataTemplate>

</ResourceDictionary>
